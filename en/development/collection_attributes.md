# RDM collection attributes

The RDM collection attributes are implemented as key-value pairs associated with the corresponding iRODS collection.  The table below summarises a list of available attributes.  Meaning of the table columns are:

* __key__: the attribute key
* __value / format__: the value and/or the format of the value
* __multiple__: whether the attribute can have multiple values
* __sys__: whether the attribute value is update/generated by system
* __DAC__: whether the attribute is presented with a Data Acquisition Collection
* __RDC__: whether the attribute is presented with a Research Documentation Collection
* __DSC__: whether the attribute is presented with a Data Sharing Collection
* __SS__: whether the attribute is presented with a collection snapshot.  A snapshot refers to either a closed DSC, or a version of DAC/RDC. The flag `Y` indicates the value is given at the time the snapshot is created; while the flag `C` indicates the value is copied over from the original (i.e. the head) collection. If the flag is followed by `M`, it implies that the attribute is editable (_with authorisation to be clarified_) after the snapshot is created.
* __RA__: whether the attribute is editable by a research administrator
* __MNG__: whether the attribute is editable by a collection manager 
* __CNT__: whether the attribute is editable by a collection contributor


| key                          | value / format               | multiple | sys  | DAC  | RDC  | DSC  | SS      | RA   | MNG    | CNT    |
| ---------------------------- | ---------------------------- | -------- | ---- | ---- | ---- | ---- | ------- | ---- | ---- | ---- |
| identifierEPIC               | valid EPIC identifier        |          |  Y   |      |      |      |  Y      |      |      |      |
| identifierDOI                | valid DOI identifier         |          |  Y   |      |      |      |  Y      |      |      |      |
| collectionIdentifier         | [o].[ou].[coll_name]         |          |  Y   |  Y   |  Y   |  Y   |  C      |      |      |      |
| organisation                 | `DI`                         |          |  Y   |  Y   |  Y   |  Y   |  C      |      |      |      |
| organisationalUnit           | `DCCN`,`DCC`,`DCN_S/M`       |          |  Y   |  Y   |  Y   |  Y   |  C      |      |      |      |
| projectId                    | [type]_[number]              |          |      |  Y   |  Y   |  Y   |  C      |  Y   |      |      |
| alternativeProjectId         | [type]_[number]              |    Y     |      |  Y   |  Y   |  Y   |  C      |      |   Y  |      |
| type                         | `DATA_ACQUISITION`, `RESEARCH_DOCUMENTATION`, `DATA_SHARING` |          |      |  Y   |  Y   |  Y   |  C      |      |      |      |
| title                        | string w/ UTF-8 support      |          |      |  Y   |  Y   |  Y   |  C      |  Y   |  Y   |  Y   |
| ~~subject~~ keyword_freetext | string w/ UTF-8 support      |    Y     |      |  Y   |  Y   |  Y   |  C      |      |  Y   |  Y   |
| descriptionAbstract          | string w/ UTF-8 support      |          |      |  Y   |  Y   |  Y   |  C      |      |  Y   |  Y   |
| status                       | `open`,`closed`,`tobeclosed` |          |  Y   |  Y   |  Y   |  Y   | `closed`|      |      |      |
| publisher                    | `Radboud University, Donders Institute for Brain, Cognition and Behaviour`|          |  Y   |  Y   |  Y   |  Y   |  C      |      |      |      |
| manager                      | internal iRODS user id       |    Y     |      |  Y   |  Y   |  Y   |  C      |  Y   |  Y   |      |
| contributor                  | internal iRODS user id       |    Y     |      |  Y   |  Y   |  Y   |  C      |      |  Y   |      |
| viewer                       | internal iRODS user id       |    Y     |      |  Y   |  Y   |  Y   |  C      |      |  Y   |      
| creator                      | author object<sup>[1]</sup>  |     Y    |      |      |      |      |  Y      |      |  Y   |      
| creatorList                  | ordered(ids of authors)<sup>[2]</sup>|          |      |      |      |      |  Y      |      |  Y   |      |
| locationNonDigitalRoom       | free text                    |    Y     |      |  Y   |      |      |  M      |      |  Y   |  Y   |  
| creationDateTime             | YYYY-MM-DDTHH:MM:SS (UTC)    |          |  Y   |  Y   |  Y   |  Y   |  Y      |      |      |      |
| publicationDateTime          | YYYY-MM-DDTHH:MM:SS (UTC)    |          |  Y   |      |      |      |  Y      |      |      |      |
| lastClosedDateTime           | YYYY-MM-DDTHH:MM:SS (UTC)    |          |  Y   |  Y   |  Y   |  Y   |  Y      |      |      |      |
| attributeLastUpdateDateTime  | YYYY-MM-DDTHH:MM:SS (UTC)    |          |  Y   |  Y   |  Y   |  Y   |  Y      |      |      |      |
| embargoUntilDateTime         | YYYY-MM-DDTHH:MM:SS (UTC)    |          |      |      |      |  Y   |  C      |  Y   |      |      |
| associatedDAC                | internal iRODS coll. id      |    Y     |      |      |  Y   |      |  C      |      |  Y   |  Y   |
| associatedRDC                | internal iRODS coll. id      |    Y     |      |      |      |  Y   |  C      |      |  Y   |  Y   |
| associatedDSC                | internal iRODS coll. id      |    Y     |      |      |  Y   |      |  C      |      |  Y   |  Y   |
| associatedPublication        | [_see combinatory attributes_](#combinatory-attributes) |    Y     |      |  Y   |  Y   |  Y   |  C      |      |  Y   |  Y   |
| quotaInBytes                 | numerical number             |          |      |  Y   |  Y   |  Y   |  C      |  Y   |      |      |
| sizeInBytes                  | numerical number             |          |  Y   |  Y   |  Y   |  Y   |  C      |      |      |      |
| numberOfFiles                | numerical number             |          |  Y   |  Y   |  Y   |  Y   |  C      |      |      |      |
| preservationTimeYear         | numerical number             |          |      |  Y   |  Y   |  Y   |  C      |  Y   |      |      |
| ethicalApprovalIdentifier    | [_see combinatory attributes_](#combinatory-attributes) |    Y     |      |  Y   |      |      |  C      |      |  Y   |  Y   |
| [dataUseAgreement](../guides/sharing.md) | valid DUA identifier         |          |      |      |      |  Y   |  C      |      |  Y   |      |
| [keyword_MeSH_2015](vocabularies.md)| word in MeSH 2015 vocab.     |    Y     |      |      |      |  Y   |  C      |      |  Y   |  Y   |
| [keyword_SFN_2013](vocabularies.md)| word in SFN 2013 vocab.      |    Y     |      |      |      |  Y   |  C      |      |  Y   |  Y   |
| versionNumber                | numerical number             |          |  Y   |      |      |      |  C      |      |      |      |
| latestVersionId              | internal iRODS coll. id      |          |  Y   |  Y   |  Y   |  Y   |         |      |      |      |
| originalVersionId            | internal iRODS coll. id      |          |  Y   |      |      |      |  Y      |      |      |      |
| perviousVersionId            | internal iRODS coll. id      |          |  Y   |      |      |      |  Y      |      |      |      |
| nextVersionId                | internal iRODS coll. id      |          |  Y   |      |      |      |  Y      |      |      |      |

Note:
<sup>[1]</sup> The __creator__ attribute is used internally to store the detail of each individual author in a JSON string. The JSON string "must" contains an identifier, the "id", to identify the author in the collection scope. The order of the authors is maintained by the _creatorList_ attribute.

Note:
<sup>[2]</sup> The __creatorList__ attribute stores a JSON list of _creator_ ids, and thus the order of the authors is maintained. Detail of authors are stored in the corresponding _creator_ attributes referred by the id.

## Mandatory attributes for collection closure

The following table summarise a list of attributes to be set before closing a collection, with respect to different collection types.  Collection closure is forbidden if the collection does not have all mandatory attributes set properly.

The list does not include system-generated attributes (see the `sys` column in the table above) which are assumed to be always set properly before (or at the time of) closing a collection.

|  Key of attribute         |  DAC  |  RDC  |  DSC  |
| ------------------------- | ----- | ----- | ----- |
| title                     |   Y   |   Y   |   Y   |
| type                      |   Y   |   Y   |   Y   |
| projectId                 |   Y   |   Y   |   Y   |
| creatorList               |   Y   |   Y   |   Y   |
| descriptionAbstract       |       |       |   Y   |
| keyword_*<sup>[1]</sup>   |       |       |   Y   |
| ethicalApprovalIdentifier |   Y   |       |       |
| dataUseAgreement          |       |       |   Y   |
| embargoUntilDateTime      |       |       |   Y   |
| preservationTimeYear      |   Y   |   Y   |   Y   |

Note:
<sup>[1]</sup> For closing a DSC, at-least one keyword must be specified.  The specification can be done via freetext keyword (i.e. `keyword_freetext`), or keyword provided by controlled vocabularies (i.e. `keyword_MeSH_2015` and `keyword_SFN_2013`).

## Combinatory attributes

Combinatory attributes are those with value containing a data structure of key-value pairs. In this case, the value is stored as the string representation of a JSON object.

The table summarises a list of combinatory collection attributes with examples of their values.

|   key of attribute           | JSON representation |
| ---------------------------- | ------------------- |
| associatedPublication        |                     |
| ethicalApprovalIdentifier    | `{ "reviewBoard": "METC Regio Arnhem-Nijmegen", "approvalIdentifier" : "CMO2014/288" }` |
